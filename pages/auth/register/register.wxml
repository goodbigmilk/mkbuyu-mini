<view class="register-page">
  <!-- 顶部背景 -->
  <view class="top-bg">
    <view class="bg-gradient"></view>
    <view class="bg-overlay"></view>
  </view>

  <!-- 注册容器 -->
  <view class="register-container">
    <!-- Logo和标题 -->
    <view class="header">
      <image class="logo" src="/assets/images/logo.jpg" mode="aspectFit" />
      <text class="title">注册买不语</text>
      <text class="subtitle">开启您的购物之旅</text>
    </view>

    <!-- 注册表单 -->
    <view class="register-form">
      <!-- 身份选择 -->
      <view class="user-type-tabs">
        <view 
          class="type-tab {{role === 'user' ? 'active' : ''}}"
          bindtap="switchRole"
          data-type="user"
        >
          <van-icon name="user-o" />
          <text>买家注册</text>
        </view>
        <view 
          class="type-tab {{role === 'shop' ? 'active' : ''}}"
          bindtap="switchRole"
          data-type="shop"
        >
          <van-icon name="shop-o" />
          <text>卖家注册</text>
        </view>
      </view>

      <!-- 手机号 -->
      <view class="input-group">
        <van-field
          model:value="{{phone}}"
          type="number"
          placeholder="请输入手机号"
          border="{{false}}"
          maxlength="11"
          custom-class="register-input"
          bind:input="onPhoneInput"
        >
          <van-icon slot="left-icon" name="phone-o" />
        </van-field>
      </view>

      <!-- 验证码 -->
      <view class="input-group">
        <van-field
          model:value="{{smsCode}}"
          type="number"
          placeholder="请输入验证码"
          border="{{false}}"
          maxlength="6"
          custom-class="register-input"
          use-button-slot
          bind:input="onSmsCodeInput"
        >
          <van-icon slot="left-icon" name="shield-o" />
          <van-button 
            slot="button" 
            size="small" 
            type="primary"
            disabled="{{!canSendSms || smsCountdown > 0}}"
            loading="{{sendingSms}}"
            bindtap="onSendSms"
            custom-class="sms-btn"
          >
            {{smsCountdown > 0 ? smsCountdown + 's' : '获取验证码'}}
          </van-button>
        </van-field>
      </view>

      <!-- 密码 -->
      <view class="input-group">
        <van-field
          model:value="{{password}}"
          type="password"
          placeholder="请设置登录密码(6-20位)"
          border="{{false}}"
          maxlength="20"
          custom-class="register-input"
          bind:input="onPasswordInput"
        >
          <van-icon slot="left-icon" name="lock" />
        </van-field>
      </view>

      <!-- 确认密码 -->
      <view class="input-group">
        <van-field
          model:value="{{confirmPassword}}"
          type="password"
          placeholder="请再次输入密码"
          border="{{false}}"
          maxlength="20"
          custom-class="register-input"
          bind:input="onConfirmPasswordInput"
        >
          <van-icon slot="left-icon" name="lock" />
        </van-field>
      </view>

      <!-- 卖家专用字段 -->
      <block wx:if="{{role === 'shop'}}">
        <!-- 店铺名称 -->
        <view class="input-group">
          <van-field
            model:value="{{shopName}}"
            placeholder="请输入店铺名称"
            border="{{false}}"
            custom-class="register-input"
            bind:input="onShopNameInput"
          >
            <van-icon slot="left-icon" name="shop-o" />
          </van-field>
        </view>

        <!-- 店主姓名 -->
        <view class="input-group">
          <van-field
            model:value="{{ownerName}}"
            placeholder="请输入店主姓名"
            border="{{false}}"
            custom-class="register-input"
            bind:input="onOwnerNameInput"
          >
            <van-icon slot="left-icon" name="contact" />
          </van-field>
        </view>
      </block>

      <!-- 邀请码（可选）- 仅买家显示 -->
      <view class="input-group" wx:if="{{role === 'user'}}">
        <van-field
          model:value="{{inviteCode}}"
          placeholder="邀请码（可选）"
          border="{{false}}"
          custom-class="register-input"
          bind:input="onInviteCodeInput"
        >
          <van-icon slot="left-icon" name="gift-o" />
        </van-field>
      </view>

      <!-- 注册按钮 -->
      <van-button 
        type="primary" 
        size="large"
        loading="{{registering}}"
        disabled="{{!canRegister}}"
        bindtap="onRegister"
        custom-class="register-btn"
      >
        {{registering ? '注册中...' : '立即注册'}}
      </van-button>

      <!-- 已有账号 -->
      <view class="bottom-links">
        <text>已有账号？</text>
        <text class="link" bindtap="onLogin">立即登录</text>
      </view>
    </view>

    <!-- 协议同意 -->
    <view class="agreement">
      <van-checkbox 
        value="{{agreePolicy}}" 
        bind:change="onAgreePolicyChange"
        checked-color="#1989fa"
      >
        我已阅读并同意
      </van-checkbox>
      <text class="policy-link" bindtap="onViewPolicy" data-type="user">《用户协议》</text>
      <text>和</text>
      <text class="policy-link" bindtap="onViewPolicy" data-type="privacy">《隐私政策》</text>
    </view>
  </view>
</view> 