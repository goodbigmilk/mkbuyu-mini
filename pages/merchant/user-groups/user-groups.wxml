<view class="container">
  <!-- 操作栏 -->
  <view class="action-bar">
    <van-button 
      type="primary" 
      size="small" 
      icon="plus"
      bindtap="showCreateDialog"
    >
      新建分组
    </van-button>
    
    <view class="stats-info">
      <text class="stats-text">共 {{total}} 个分组</text>
    </view>
  </view>

  <!-- 分组列表 -->
  <view wx:if="{{groupList.length > 0}}" class="group-list">
    <!-- 列表头部 -->
    <view class="list-header">
      <text class="header-item name">分组名称</text>
      <text class="header-item members">成员数</text>
      <text class="header-item status">状态</text>
      <text class="header-item actions">操作</text>
    </view>
    
    <!-- 分组项 -->
    <view 
      wx:for="{{groupList}}" 
      wx:key="id" 
      class="group-item {{item.status === 2 ? 'disabled' : ''}}"
    >
      <view class="item-content">
        <view class="group-info name">
          <text class="group-name">{{item.name}}</text>
          <text wx:if="{{item.description}}" class="group-desc">{{item.description}}</text>
        </view>
        
        <view class="group-members members">
          <text class="member-count">{{item.member_count || 0}}</text>
        </view>
        
        <view class="group-status status">
          <van-tag 
            type="{{item.status === 1 ? 'success' : 'default'}}"
            size="medium"
          >
            {{item.status === 1 ? '启用' : '禁用'}}
          </van-tag>
        </view>
        
        <view class="group-actions actions">
          <van-button 
            size="mini" 
            type="default" 
            bindtap="showEditDialog"
            data-group="{{item}}"
          >
            编辑
          </van-button>
          
          <van-button 
            size="mini" 
            type="primary" 
            bindtap="viewGroupMembers"
            data-group="{{item}}"
          >
            成员
          </van-button>
          
          <van-button 
            size="mini" 
            type="warning" 
            bindtap="setGroupPricing"
            data-group="{{item}}"
          >
            定价
          </van-button>
          
          <van-button 
            size="mini" 
            type="{{item.status === 1 ? 'default' : 'success'}}" 
            bindtap="toggleGroupStatus"
            data-group="{{item}}"
          >
            {{item.status === 1 ? '禁用' : '启用'}}
          </van-button>
          
          <van-button 
            size="mini" 
            type="danger" 
            bindtap="deleteGroup"
            data-group="{{item}}"
          >
            删除
          </van-button>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <van-empty 
    wx:else
    image="search" 
    description="暂无分组数据"
  >
    <van-button 
      type="primary" 
      size="small"
      bindtap="showCreateDialog"
    >
      立即创建
    </van-button>
  </van-empty>

  <!-- 加载更多 -->
  <van-loading wx:if="{{loading}}" type="spinner" class="loading-more">
    加载中...
  </van-loading>

  <!-- 创建/编辑分组对话框 -->
  <van-dialog
    use-slot
    title="{{editingGroup ? '编辑分组' : '新建分组'}}"
    show="{{showCreateDialog}}"
    show-cancel-button
    bind:close="closeDialog"
    bind:confirm="submitForm"
  >
    <view class="dialog-content">
      <van-field
        label="分组名称"
        placeholder="请输入分组名称"
        border="{{false}}"
        value="{{formData.name}}"
        data-field="name"
        bind:input="onFormInput"
        required
      />
      
      <van-field
        label="分组描述" 
        placeholder="请输入分组描述(可选)"
        border="{{false}}"
        type="textarea"
        autosize
        value="{{formData.description}}"
        data-field="description"
        bind:input="onFormInput"
      />
    </view>
  </van-dialog>

  <!-- 商家端TabBar -->
  <merchant-tabbar current="{{tabbarCurrent}}" />
</view>