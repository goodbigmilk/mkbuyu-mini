<wxs module="utils">
  // 格式化价格（分转元）
  function formatPrice(price) {
    if (!price) return '0.00';
    return (price / 100).toFixed(2);
  }
</wxs>

<view class="container">
  <!-- 顶部欢迎区域 -->
  <view class="welcome-section">
    <view class="welcome-content">
      <view class="shop-info">
        <image class="shop-avatar" src="{{shopInfo.logo}}" />
        <view class="shop-details">
          <view class="shop-name">{{shopInfo.name || '我的店铺'}}</view>
        </view>
      </view>
      <view class="quick-actions">
        <view class="action-btn" bindtap="onSettings">
          <van-icon name="setting-o" size="20" />
        </view>
      </view>
    </view>
  </view>



  <!-- 待处理事务 -->
  <view class="pending-section">
    <view class="section-title">待处理</view>
    <view class="pending-list">
      <view class="pending-item" bindtap="onPendingTap" data-type="orders">
        <view class="pending-icon orders">
          <van-icon name="pending-payment" size="24" />
        </view>
        <view class="pending-content">
          <view class="pending-title">待发货订单</view>
          <view class="pending-desc">{{pendingCounts.orders || 0}}个订单等待发货</view>
        </view>
        <view class="pending-count">{{pendingCounts.orders || 0}}</view>
        <van-icon name="arrow" size="16" />
      </view>

      <view class="pending-item" bindtap="onPendingTap" data-type="refunds">
        <view class="pending-icon refunds">
          <van-icon name="exchange" size="24" />
        </view>
        <view class="pending-content">
          <view class="pending-title">退款申请</view>
          <view class="pending-desc">{{pendingCounts.refunds || 0}}个退款申请待处理</view>
        </view>
        <view class="pending-count">{{pendingCounts.refunds || 0}}</view>
        <van-icon name="arrow" size="16" />
      </view>

      <view class="pending-item" bindtap="onPendingTap" data-type="stock">
        <view class="pending-icon stock">
          <van-icon name="warning-o" size="24" />
        </view>
        <view class="pending-content">
          <view class="pending-title">库存预警</view>
          <view class="pending-desc">{{pendingCounts.lowStock || 0}}个商品库存不足</view>
        </view>
        <view class="pending-count">{{pendingCounts.lowStock || 0}}</view>
        <van-icon name="arrow" size="16" />
      </view>

      <view class="pending-item" bindtap="onPendingTap" data-type="reviews">
        <view class="pending-icon reviews">
          <van-icon name="comment-o" size="24" />
        </view>
        <view class="pending-content">
          <view class="pending-title">待回复评价</view>
          <view class="pending-desc">{{pendingCounts.reviews || 0}}条评价待回复</view>
        </view>
        <view class="pending-count">{{pendingCounts.reviews || 0}}</view>
        <van-icon name="arrow" size="16" />
      </view>
    </view>
  </view>

  <!-- 快捷操作 -->
  <view class="shortcuts-section">
    <view class="section-title">快捷操作</view>
    <view class="shortcuts-grid">
      <view class="shortcut-item" bindtap="onShortcutTap" data-type="add-product">
        <view class="shortcut-icon">
          <van-icon name="add-square" size="28" />
        </view>
        <text class="shortcut-label">添加商品</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="manage-products">
        <view class="shortcut-icon">
          <van-icon name="goods-collect-o" size="28" />
        </view>
        <text class="shortcut-label">商品管理</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="order-management">
        <view class="shortcut-icon">
          <van-icon name="orders-o" size="28" />
        </view>
        <text class="shortcut-label">订单管理</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="data-analysis">
        <view class="shortcut-icon">
          <van-icon name="bar-chart-o" size="28" />
        </view>
        <text class="shortcut-label">数据分析</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="customer-service">
        <view class="shortcut-icon">
          <van-icon name="service-o" size="28" />
        </view>
        <text class="shortcut-label">客服管理</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="marketing">
        <view class="shortcut-icon">
          <van-icon name="fire-o" size="28" />
        </view>
        <text class="shortcut-label">营销推广</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="finance">
        <view class="shortcut-icon">
          <van-icon name="balance-o" size="28" />
        </view>
        <text class="shortcut-label">财务管理</text>
      </view>

      <view class="shortcut-item" bindtap="onShortcutTap" data-type="settings">
        <view class="shortcut-icon">
          <van-icon name="setting-o" size="28" />
        </view>
        <text class="shortcut-label">店铺设置</text>
      </view>
    </view>
  </view>

  <!-- 最新动态 -->
  <view class="activity-section">
    <view class="section-title">最新动态</view>
    <view wx:if="{{activities.length}}" class="activity-list">
      <view wx:for="{{activities}}" wx:key="id" class="activity-item" bindtap="onActivityTap" data-activity="{{item}}">
        <view class="activity-time">{{formatTime(item.created_at)}}</view>
        <view class="activity-content">
          <view class="activity-title">{{item.title}}</view>
          <view class="activity-desc">{{item.description}}</view>
        </view>
        <view class="activity-type {{item.type}}">{{item.type_name}}</view>
        <van-icon name="arrow" size="16" />
      </view>
    </view>
    <view wx:else class="empty-activity">
      <van-empty description="暂无动态" />
    </view>
  </view>

  <!-- 底部间距 -->
  <view class="bottom-space"></view>

  <!-- 商家端TabBar -->
  <merchant-tabbar current="{{tabbarCurrent}}" />
</view> 